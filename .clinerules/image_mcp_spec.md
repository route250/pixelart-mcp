# image_mcpの仕様

## 概要

画像生成、ピクセルアート生成を行うMCPプロトコルサーバ
mcp-python-sdkによる実装で、stdio,sse,streaminghttpをサポート
see: docs/mcp-python-sdk-README.md
処理はバックグラウンドジョブ方式で、ジョブキューによるバックグラウンド処理
ジョブ投入、ジョブ一覧、ジョブキャンセル、削除の機能を提供する
LLMは、ジョブを投入したあと、ジョブリストで確認し、完了していたらリストのファイルパスを使用たらいい。

## 提供するツール

### 画像生成ジョブ投入

通常の画像生成処理を投入する
パラメータは、生成プロンプト、画像サイズ横、画像サイズ縦、出力ファイルパス
結果としてジョブIDを返す

### ピクセルアート投入

ピクセルアート生成処理を投入する
パラメータは、生成プロンプト、生成サイズ(32,64,48,128のいずれか縦横同値)、出力ファイルパス
結果としてジョブIDを返す

### ジョブリスト

完了・キャンセル・実行中のジョブの一覧を返す。
リストは、jsonで、ジョブID、開始時刻、経過時間、終了時間、状態、投入パラメータを返す

### ジョブ取得

ジョブの状態を取得する
パラメータは、ジョブID
ジョブのパラメータと実行ログを返す。

### ジョブキャンセル

実行中のジョブをキャンセルして停止させる
パラメータは、ジョブID
ジョブ取得と同じものを返す

### ジョブ削除

不要になったジョブを削除する。
パラメータは、ジョブID

## データとか

{ImageDir}/ コマンドラインで指定されるディレクトリ、デフォルトは、$HOME/.cache/image_mcp
  - logs/*.log  mcpサーバの実行ログ
  - jobs/xxxxxx/  ジョブのディレクトリ xxxxxxがジョブID
  - jobs/xxxxxx/image.log  生成処理のログ
  - jobs/xxxxxx/job.json   実行状態、内容とかジョブリストに必要な内容
  - jobs/xxxxxx/*          そのほかジョブ実行に必要なファイルとか一時ファイルとか
  